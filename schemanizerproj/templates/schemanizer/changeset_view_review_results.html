{% extends 'site_base.html' %}

{% block title %}{{ block.super }} - Changeset Review Results{% endblock %}

{% block contents %}
    {% if user_has_access %}
        <h2>Changeset Review Results</h2>

        {% if changeset_review_success %}
            <h3><span class="text-success">ACCEPTED</span></h3>
        {% endif %}
        {% if changeset_review_failed %}
            <h3><span class="text-error">REJECTED</span></h3>
        {% endif %}

        <h3>Changeset Validations</h3>
        <table class="table table-striped table-condensed table-bordered table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Changeset ID</th>
                    <th>Validation type</th>
                    <th>Timestamp</th>
                    <th>Result</th>
                </tr>
            </thead>
            <tbody>
                {% for changeset_validation in changeset_validations %}
                    <tr>
                        <td>{{ changeset_validation.id }}</td>
                        <td><a href="{% url 'schemanizer_changeset_view' changeset_validation.changeset_id %}">{{ changeset_validation.changeset_id }}</a></td>
                        <td>{{ changeset_validation.validation_type }}</td>
                        <td>{{ changeset_validation.timestamp }}</td>
                        <td>{{ changeset_validation.result }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <h3>Changeset Tests</h3>
        <table class="table table-striped table-condensed table-bordered table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Changeset detail ID</th>
                    <th>Test type</th>
                    <th>Environment</th>
                    <th>Server</th>
                    <th>Started at</th>
                    <th>Ended at</th>
                    <th>Results log</th>
                </tr>
            </thead>
            <tbody>
            {% for changeset_test in changeset_tests %}
                <tr>
                    <td>{{ changeset_test.id }}</td>
                    <td>{{ changeset_test.changeset_detail_id }}</td>
                    <td>{{ changeset_test.test_type }}</td>
                    <td>{{ changeset_test.environment }}</td>
                    <td>{{ changeset_test.server }}</td>
                    <td>{{ changeset_test.started_at }}</td>
                    <td>{{ changeset_test.ended_at }}</td>
                    <td>{{ changeset_test.results_log }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>

        <p><a href="{% url 'schemanizer_changeset_view' changeset.id %}">Click here to view changeset.</a></p>
    {% endif %}
{% endblock %}