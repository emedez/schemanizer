{% extends 'site_base.html' %}

{% block title %}{{ block.super }} - Changesets{% endblock %}
{% block class_changesets %}active{% endblock %}

{% block contents %}
    <h2>Changesets</h2>
    <p><a href="{% url 'schemanizer_changeset_submit' %}">Click here to submit new changeset</a></p>
    {% if changesets %}
        <table class="table table-striped table-condensed table-bordered table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Database schema</th>
                    <th>Type</th>
                    <th>Classification</th>
                    <th>Version control URL</th>
                    <th>Submitted by</th>
                    <th>Submitted at</th>
                    <th>Review status</th>
                    <th>Reviewed by</th>
                    <th>Reviewed at</th>
                    <th>Approved by</th>
                    <th>Approved at</th>
                    <th>Created at</th>
                    <th>Updated at</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
            {% for changeset in changesets %}
                <tr>
                    <td>{{ changeset.id }}</td>
                    <td>{{ changeset.database_schema }}</td>
                    <td>{{ changeset.type }}</td>
                    <td>{{ changeset.classification }}</td>
                    <td>{{ changeset.version_control_url }}</td>
                    <td>{{ changeset.submitted_by }}</td>
                    <td>{{ changeset.submitted_at }}</td>
                    <td>{{ changeset.review_status }}</td>
                    <td>{{ changeset.reviewed_by|default_if_none:'' }}</td>
                    <td>{{ changeset.reviewed_at|default_if_none:'' }}</td>
                    <td>{{ changeset.approved_by|default_if_none:'' }}</td>
                    <td>{{ changeset.approved_at|default_if_none:'' }}</td>
                    <td>{{ changeset.created_at }}</td>
                    <td>{{ changeset.updated_at }}</td>
                    <td>
                        <a href="{% url 'schemanizer_changeset_view' changeset.id %}">View</a>
                        | <a href="{% url 'schemanizer_changeset_view_review_results' changeset.id %}">View Review Results</a>
                        {% if can_soft_delete %}
                            | <a href="{% url 'schemanizer_changeset_soft_delete' changeset.id %}">Delete</a>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="text-info"><em>No changesets.</em></p>
    {% endif %}
{% endblock %}