{% extends 'site_base.html' %}

{% block title %}{{ block.super }} - Changeset Reviews{% endblock %}

{% block contents %}
    <h2>Changeset Reviews</h2>

    <p class="text-info">
    If you expect a task to be visible here, try reloading this page, the task
    might not have been started yet when this page was loaded.
    </p>

    {% if task_state_list %}
        <table class="table table-striped table-condensed table-bordered table-hover">
            <thead>
                <tr>
                    <th>Started</th>
                    {% comment %}
                    <th>Task ID</th>
                    {% endcomment %}
                    <th>State</th>
                    <th>Changeset</th>
                    <th>Result</th>
                </tr>
            </thead>
            <tbody>
                {% for task_state in task_state_list %}
                    <tr>
                        <td>{{ task_state.tstamp }}</td>
                        {% comment %}
                        <td>{{ task_state.task_id }}</td>
                        {% endcomment %}
                        <td>{{ task_state.state }}</td>
                        <td>
                            {% if task_state.show_changeset_view_url %}
                                <a href="{% url 'schemanizer_changeset_view' task_state.changeset_id %}">
                                    Changeset ID: {{ task_state.changeset_id }}
                                </a>
                            {% else %}
                                Changeset ID: {{ task_state.changeset_id }}
                            {% endif %}
                        </td>
                        <td>
                            {% if task_state.show_message %}
                                <p class="text-{{ task_state.result.message_type }}">{{ task_state.result.message }}</p>
                            {% else %}
                                {{ task_state.result }}
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="text-info"><em>No changeset review is currently ongoing.</em></p>
    {% endif %}
{% endblock %}